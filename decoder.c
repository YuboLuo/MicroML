#include "stdio.h"
#include "stdint.h"

void decode(){

    // FILE *file;
    // file = fopen("model.csv", "r");

    int16_t array[2048] = {0,0,0,16,32,-1009,1130,451,951,273,988,-500,-265,1045,-133,-721,52,60,979,-112,941,537,1076,-66,-1349,-120,-950,-312,-1346,393,-30,24,402,-175,-314,-569,-216,836,681,127,-358,-1145,320,-478,2380,515,1252,262,1257,-126,-304,-296,320,481,-690,-835,-924,-276,-659,718,-685,667,417,278,738,-143,-8,-868,-113,-369,-171,200,435,364,704,-40,-235,502,70,100,-325,-391,-781,-182,549,1339,-940,-300,390,-896,379,494,420,673,555,-1268,-528,1390,-806,363,1021,632,328,-315,848,-520,-18,-366,-138,452,189,1230,-1008,1027,-879,-992,438,-589,957,1136,-189,-312,-408,-188,-457,-1377,-1184,-261,-49,-247,252,-794,111,499,-392,-805,1298,530,-77,719,-781,-128,211,179,-616,-416,-748,-42,183,-902,89,-659,-927,241,-686,1298,-493,374,-73,-348,470,-1672,866,827,143,-296,726,-1044,760,102,-290,1347,103,-880,-26,-561,182,-263,-4,575,822,-104,469,196,-1023,-1361,870,-761,-600,815,-1665,-157,-156,-941,279,278,-76,-808,-642,430,-173,1878,399,-948,884,-841,1123,980,145,435,-220,-932,387,297,-997,1343,-605,211,1254,-915,340,552,-10,150,-299,29,-1113,-299,-831,-145,-360,-511,170,960,-992,-425,167,-2091,716,365,-659,977,240,-44,335,1023,-439,681,-243,-606,607,-416,2011,-419,457,552,-295,998,-422,-718,640,378,1344,19,1018,-367,-16,-34,-114,-219,450,514,-626,416,-1120,-585,-924,428,-905,65,-1186,-1265,321,-1481,-152,-914,-1942,-449,-1138,-201,-811,-829,-276,466,-1165,520,-1401,240,560,-195,1141,846,147,230,1170,-750,148,747,-921,-282,-325,318,-1,726,-1571,-425,-1486,-320,-394,237,-511,-608,624,-1765,6,-636,-257,-1012,-131,485,-718,409,387,743,171,730,-617,1484,143,-675,1039,-972,-293,-70,-815,557,-569,111,181,-612,865,312,1549,-1100,1602,1404,1474,-1015,688,-327,393,286,57,843,-213,567,-996,-322,117,364,1910,139,1831,217,-577,-979,890,65,789,345,-100,208,-94,-502,90,-236,-471,745,-179,-397,245,-266,-599,-562,-652,774,686,1028,-635,797,557,1006,0,590,-566,-737,-695,-147,-356,-232,1240,64,1076,668,-1006,-1276,-583,-498,-398,564,198,353,-719,1201,549,-1058,1109,-1250,-443,2060,194,-260,-659,242,-383,529,1461,-1441,-774,3,138,537,220,586,-1077,1030,-220,-202,100,650,-429,592,-1196,-446,679,-336,238,-759,53,436,176,224,1239,-205,1297,-65,643,-507,-326,-505,452,-87,-419,285,-1,-336,-33,-1095,-45,325,1207,-465,540,1629,-1351,446,-188,-1296,-77,344,-1510,488,-605,-777,970,-195,668,563,762,-768,1493,-16,-567,-231,-895,254,-511,434,-959,-16,447,-642,438,-210,-426,-113,-1960,32,1,-455,148,710,324,-949,669,-752,-459,-550,-629,-369,363,999,20,73,-325,-2022,-89,656,500,97,949,912,-544,35,585,760,-884,-368,-313,1329,174,1,0,0,32,10,747,453,-283,1013,-977,822,554,-424,-1674,646,-523,340,112,-729,133,640,-1242,718,243,276,677,-1284,1033,-1020,342,-1843,1224,-774,636,-676,141,964,-389,-554,-11,-174,-63,-83,-1573,186,-242,-662,-885,985,64,277,-1962,-1034,-187,1032,1017,329,160,-992,-1267,276,525,328,-1573,880,-373,304,-1136,790,-1724,-636,-2145,-250,-106,-284,-216,163,542,211,438,-1857,-2353,-479,611,-1103,349,-240,-202,-909,-863,-787,-1889,682,-160,40,-3110,483,-1176,513,-135,733,236,-522,-1256,-313,226,-113,309,-904,610,-302,-163,-1444,449,-160,-348,-1391,470,-1949,-2154,829,337,-537,-2014,470,-460,-560,141,371,-80,135,-369,113,-316,241,89,-38,-1508,-2142,163,-389,-1165,228,130,567,-888,-250,-12,-861,258,-35,-890,-1805,-950,-711,-634,-1080,848,-1305,-245,-124,504,839,-1724,459,207,426,373,-309,343,-516,756,-400,-83,795,504,675,966,732,-39,532,995,-575,-1790,-514,-1659,1374,824,-381,-1299,-371,159,-791,-1240,-1101,614,-751,-302,435,-2824,136,-1479,-128,417,680,-576,251,-1243,570,-924,-1464,142,231,-119,1034,-778,1031,-645,-716,-944,-1118,-310,-908,-400,-807,-959,-1599,-945,-157,1101,-565,278,-1238,31,-1060,-33,1134,41,-537,441,-189,-636,-1477,-352,-684,-99,-477,-580,124,333,-512,540,561,220,520,-1202,114,667,99,-1394,-1189,148,579,579,393,113,1440,-537,280,129,-1714,369,-113,1247,262,420,123,-2210,294,-15,1128,528,-331,679,54,-723,1014,373,-765,164,-1946,1226,-1235,-1013,-1451,873,300,-183,332,835,-946,-194,426,-610,-466,398,297,219,568,367,-1653,345,-825,751,850,511,-440,410,-1377,746,-1569,-467,764,101,-945,10,1,-38,170,-189,-255,303,-112,-621,-276,860,334,1};
    int16_t i = 0;
    
    // while (!feof(file)){
    //     fscanf(file, "%hd,", &array[i]);
    //     i ++;
    // }

    int16_t array_length = 889;
    int16_t *layer_class, *activation, *kernel_numRow, *kernel_numCol, *bias_numRow, *bias_numCol, *output_numRow, *output_numCol;

    i = 0;
    // Sequential model
    if (array[i] == 0){
        i ++;
        while (i < array_length){
            // DENSE == 0
            if (array[i] == 0){
                layer_class = &array[i];
                printf("layer class:%hd\n", *layer_class);
                activation = &array[i+1];
                printf("activation:%hd\n", *activation);
                kernel_numRow = &array[i+2];
                printf("kernel Row:%hd\n", *kernel_numRow);
                kernel_numCol = &array[i+3];
                printf("kernel Col:%hd\n", *kernel_numCol);
                i += 4;

                int16_t kernel_length = (*kernel_numRow) * (*kernel_numCol);
                int16_t *kernel_array = &array[i];
                printf("kernel start:%hd\n", *kernel_array);
                i += kernel_length;
                printf("kernel end:%hd %hd\n", kernel_array[kernel_length - 1], array[i - 1]);

                bias_numRow = &array[i];
                printf("bias Row:%hd\n", *bias_numRow);
                bias_numCol = &array[i+1];
                printf("bias Col:%hd\n", *bias_numCol);
                i += 2;

                int16_t bias_length = (*bias_numRow) * (*bias_numCol);
                int16_t *bias_array = &array[i];
                printf("bias start:%hd\n", *bias_array);
                i += bias_length;
                printf("bias end:%hd %hd\n", bias_array[bias_length - 1], array[i - 1]);

                output_numRow = &;
                output_numCol = &array[i+1];

                int16_t output_length = (*output_numRow) * (*output_numCol);


                // All variables are ready, call API

                printf("next:%hd %hd %hd\n", array[i], array[i+1], array[i+2]);
                // printf("bias_array starts:%hd\n", bias_array[0]);
                // printf("bias_array ends:%hd\n", bias_array[bias_length - 1]);

                //
                return;
            }
            // LeakyReLU == 1
            else if (array[i] == 1){
                i += 1;
            }
        }
    }
}

void main(){
    decode();
}
